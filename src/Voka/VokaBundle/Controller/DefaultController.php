<?php

namespace Voka\VokaBundle\Controller;

use Doctrine\ODM\MongoDB\DocumentManager;
use Symfony\Bundle\FrameworkBundle\Controller\Controller;
use Symfony\Component\HttpFoundation\JsonResponse;
use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\HttpFoundation\Response;

class DefaultController extends Controller {

    public function indexAction() {
        return $this->render('VokaBundle:Default:index.html.twig');
    }

    public function getVokabelAction() {
        /** @var DocumentManager $dm */
        $dm = $this->get('doctrine_mongodb.odm.document_manager');

        $id = $this->ids[array_rand($this->ids)];

        $vokabel = null;
        $i = 0;
        while($vokabel === null) {
            $doc = $dm->find('VokaBundle:Country', $id);

            if(is_object($doc) && property_exists($doc, 'title')){
                $vokabel = $doc;
            }
            $i++;
            if($i > 20){
                return new JsonResponse('problemo');
            }
        }

        $serializer = $this->get('jms_serializer');
        $blub = $serializer->serialize($vokabel, 'json');
        //var_dump($blub);
        return new Response($blub);
    }


    private $ids = ['Q752265',
        'Q4355450',
        'Q33',
        'Q16',
        'Q17',
        'Q20',
        'Q27',
        'Q28',
        'Q29',
        'Q30',
        'Q31',
        'Q32',
        'Q34',
        'Q36',
        'Q35',
        'Q38',
        'Q39',
        'Q40',
        'Q41',
        'Q43',
        'Q45',
        'Q77',
        'Q79',
        'Q96',
        'Q114',
        'Q115',
        'Q117',
        'Q142',
        'Q145',
        'Q148',
        'Q155',
        'Q183',
        'Q184',
        'Q189',
        'Q191',
        'Q211',
        'Q212',
        'Q213',
        'Q214',
        'Q217',
        'Q218',
        'Q219',
        'Q221',
        'Q222',
        'Q224',
        'Q225',
        'Q227',
        'Q228',
        'Q229',
        'Q232',
        'Q238',
        'Q252',
        'Q258',
        'Q262',
        'Q298',
        'Q347',
        'Q398',
        'Q399',
        'Q408',
        'Q423',
        'Q424',
        'Q574',
        'Q657',
        'Q664',
        'Q668',
        'Q672',
        'Q678',
        'Q686',
        'Q1246',
        'Q63480',
        'Q282655',
        'Q590820',
        'Q599777',
        'Q842924',
        'Q976850',
        'Q1053347',
        'Q1392085',
        'Q1507158',
        'Q2116442',
        'Q2200589',
        'Q2462496',
        'Q2564352',
        'Q2820579',
        'Q2961285',
        'Q3397406',
        'Q3949899',
        'Q4267117',
        'Q695',
        'Q697',
        'Q710',
        'Q711',
        'Q736',
        'Q754',
        'Q783',
        'Q784',
        'Q786',
        'Q790',
        'Q794',
        'Q796',
        'Q801',
        'Q810',
        'Q813',
        'Q817',
        'Q819',
        'Q822',
        'Q826',
        'Q836',
        'Q837',
        'Q858',
        'Q865',
        'Q884',
        'Q889',
        'Q902',
        'Q912',
        'Q916',
        'Q917',
        'Q921',
        'Q928',
        'Q929',
        'Q962',
        'Q963',
        'Q965',
        'Q967',
        'Q970',
        'Q971',
        'Q977',
        'Q983',
        'Q1000',
        'Q1005',
        'Q1006',
        'Q1007',
        'Q1008',
        'Q1009',
        'Q1011',
        'Q1013',
        'Q1020',
        'Q1027',
        'Q1032',
        'Q1033',
        'Q6250',
        'Q6256',
        'Q7313',
        'Q11772',
        'Q15864',
        'Q16957',
        'Q18097',
        'Q28278',
        'Q28513',
        'Q31747',
        'Q33946',
        'Q34020',
        'Q38872',
        'Q164079',
        'Q170072',
        'Q170588',
        'Q193619',
        'Q199442',
        'Q240669',
        'Q282475',
        'Q557592',
        'Q704312',
        'Q774783',
        'Q1053351',
        'Q1072361',
        'Q1372968',
        'Q1642538',
        'Q1747689',
        'Q2001966',
        'Q2511072',
        'Q2747647',
        'Q3246797',
        'Q3297079',
        'Q3306313',
        'Q3391610',
        'Q3477306',
        'Q3477307',
        'Q3492445',
        'Q3496557',
        'Q3498769',
        'Q3502750',
        'Q3541040',
        'Q3740260',
        'Q3858507',
        'Q4027323',
        'Q4267097',
        'Q4456868',
        'Q4595478',
        'Q4598184',
        'Q4599448',
        'Q4600819',
        'Q4603644',
        'Q4605340',
        'Q4607411',
        'Q4609962',
        'Q4612587',
        'Q4747229',
        'Q4984385',
        'Q5274979',
        'Q7444352',
        'Q7444357',
        'Q11909456',
        'Q37',
        'Q5025146',
        'Q5194936',
        'Q11026135',
        'Q11292663',
        'Q13426199',
        'Q14516987',
        'Q14673853',
        'Q14984399',
        'Q16066486',
        'Q16486684',
        'Q16821150',
        'Q16869725',
        'Q17294150',
        'Q17318670',
        'Q17390140'];
}
